<div class="git-wiki-page">
  <section>

    {% include git-wiki/sections/tools/tools.html %}

    {% if site.inc_before_content %}
    {% include {{ site.inc_before_content }} %}
    {% endif %}

    <div id="git-wiki-shows-content">
      <div class="showdescription">
        <h1>{{page.title}}</h1>

        {{ content }}
      </div>

      <div class="sidebar">
        <div class="showdetails">
          <h2 id="details">Details</h2>
          <table>
            <tbody>
              {% for detail in page.details %}
              <tr>
                <td class="leftcol">{{ detail[0] }}</td>
                <td>
                  {% if detail[0] == 'Title' %}
                    {% assign values = detail[1] | split: '|nonexistent|' %}
                  {% else %}
                    {% assign values = detail[1] | split: ', ' %}
                  {% endif %}
                  {% for value in values %}
                    {% if value contains '- wiki' -%}
                      <a target="_blank" href="{{site.wikipedia}}{{ value | replace: ' - wiki', '' | strip | replace: ' ', '_' }}">{{ value | replace: ' - wiki', '' }}</a>
                    {%- elsif detail[0] == 'Web' -%}
                      <a target="_blank" href="{{ value }}" targe="_blank">Official website</a>
                    {%- elsif detail[0] == 'Theatre' -%}
                      <a target="_blank" href="/{{ value | strip | replace: ' ', '_' }}">{{ value }}</a>
                    {%- else -%}
                      {{ value | markdownify | strip | remove: '<p>' | remove: '</p>' | remove: "\r" | remove: "\n" }}
                    {%- endif %}
                    {%- unless forloop.last -%}, {%- endunless %}
                  {% endfor %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="showtimes">
          <h2 id="showtimes">Show Times</h2>
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Time</th>
              </tr>
            </thead>
            <tbody>
              {% assign showtimes = page.showtimes | newline_to_br | strip | split: '<br />' %}
              {% for showtime in showtimes %}
              {% assign date_time = showtime | date: "%A, %B %-d, %Y %H:%M" %}
              {% assign date = date_time | date: "%A, %B %-d, %Y" %}
              {% assign time = date_time | date: "%-I:%M %P" %}
              <tr>
                <td>{{ date }}</td>
                <td>{{ time }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

      </div>
      <div class="additional-content">
        <div class="castlist">
          <h2 id="castlist">Cast</h2>
          <table>
            <thead>
              <tr>
                <th>Character(s)</th>
                <th>Actor(s)</th>
              </tr>
            </thead>
            <tbody>
              {% for character in page.cast %}
              <tr>
                <td>{{ character[0] }}</td>
                <td>
                  {% assign cast_member_value = character[1] %}
                  {% assign actors = cast_member_value | newline_to_br | strip | split: '<br />' %}
                  {% for actor in actors -%}
                    {% assign actor_trimmed = actor | strip %}
                    <a href="/{{ actor_trimmed | replace: ' ', '_' }}">{{ actor_trimmed }}</a>{% unless forloop.last %}, {% endunless %}
                  {%- endfor %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="crewlist">
          <h2 id="crewlist">Crew</h2>
          <table>
            <thead>
              <tr>
                <th>Title(s)</th>
                <th>Member(s)</th>
              </tr>
            </thead>
            <tbody>
              {% for title in page.crew %}
              <tr>
                <td>{{ title[0] }}</td>
                <td>
                  {% assign crew_member_value = title[1] %}
                  {% assign members = crew_member_value | newline_to_br | strip | split: '<br />' %}
                  {% for member in members -%}
                    {% assign member_trimmed = member | strip %}
                    <a href="/{{ member_trimmed | replace: ' ', '_' }}">{{ member_trimmed }}</a>{% unless forloop.last %}, {% endunless %}
                  {%- endfor %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <div class="external-links">
          <h2 id="external-links">External Links</h2>
          <ul>
            {% for link in page.external_links %}
            <li><a href="{{ link[1] }}" target="_blank">{{ link[0] }}</a></li>
            {% endfor %}
          </ul>
        </div>
      </div>

      {% if site.inc_after_content %}
      {% include {{ site.inc_after_content }} %}
      {% endif %}
  </section>
</div>